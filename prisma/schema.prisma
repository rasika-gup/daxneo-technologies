// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  id           String   @id @default(cuid())
  name         String
  email        String   @unique
  password     String
  role         String   @default("user") // "user" or "admin"
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  reviews      Review[]
  contactQueries ContactQuery[]
}

model Review {
  id          String   @id @default(cuid())
  userId      String?
  userName    String
  userRole    String?
  company     String?
  content     String
  rating      Int      // 1-5 stars
  approved    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  user        User?    @relation(fields: [userId], references: [id], onDelete: SetNull, onUpdate: Cascade)
}

model ContactQuery {
  id          String   @id @default(cuid())
  name        String
  email       String
  company     String?
  message     String
  status      String   @default("pending") // "pending", "in-progress", "resolved"
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  userId      String?
  
  user        User?    @relation(fields: [userId], references: [id], onDelete: SetNull, onUpdate: Cascade)
}